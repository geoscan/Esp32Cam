menu "[buffered_file_transfer]"

	config BUFFERED_FILE_TRANSFER_ENABLE
		bool "Enable buffered file transfer"
		default n
		help
			AP/ESP channel has low throughput. That is because all the files
			are buffered in RAM, or elsewhere, and then transferred with that
			low-speed channel. From a user's perspective, it looks like
			background flashing.

	choice BUFFERED_FILE_TRANSFER_DEBUG_LEVEL
		prompt "[buffered_file_transfer] module debug level"
		default BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_INFO

		config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_ERROR
			bool "Error"

		config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_WARN
			bool "Warning"

		config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_INFO
			bool "Info"

		config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_DEBUG
			bool "Debug"

		config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_VERBOSE
			bool "Verbose"

	endchoice

	config BUFFERED_FILE_TRANSFER_DEBUG_LEVEL
		int
		default 1 if BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_ERROR
		default 2 if BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_WARN
		default 3 if BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_INFO
		default 4 if BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_DEBUG
		default 5 if BUFFERED_FILE_TRANSFER_DEBUG_LEVEL_VERBOSE

	choice BUFFERED_FILE_TRANSFER_BUFFER_FILE_SYSTEM
		prompt "Select buffer file system implementation"
		depends on BUFFERED_FILE_TRANSFER_ENABLE
		default BUFFERED_FILE_TRANSFER_MEMORY_PROVIDER_MALLOC

		config BUFFERED_FILE_TRANSFER_FILE_BUFFER_FILE_SYSTEM_MALLOC_RAM
			bool "malloc()"
			help
				Use malloc()-allocated continuous chunk of memory as buffer

		config BUFFERED_FILE_TRANSFER_FILE_BUFFER_FILE_SYSTEM_MALLOC_RAM_FLUSHING
			bool "Flushing malloc()"
			help
				Same as "MALLOC_RAM", but with flushing
				capabilities when the transferred file's size
				exceeds that of the underlying buffer
	endchoice

	menu "Enable implementors which are used for buffered file transfer"
		depends on BUFFERED_FILE_TRANSFER_ENABLE

		config BUFFERED_FILE_TRANSFER_IMPLEMENTOR_SALUTE_FLASH
			bool "Enable Salute SPI flash memory buffered file transfer implementor"
			help
				If enabled, a subject area-specific instance of BFT implementor
				will be instantiated; this instance will flush intermediate
				results into SPI flash memory (registered system-wide) on every
				transfer process update. This instance will be aware of SPI
				flash memory layout, and file system markup employed by the
				autopilot. The implied layout MUST match that of Autopilot.

	endmenu

endmenu
